"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const command_1 = require("@oclif/command");
const base_class_1 = tslib_1.__importDefault(require("../../lib/base-class"));
class Add extends base_class_1.default {
    async run() {
        const { flags: { spreadsheetTitle = '' }, } = this.parse(Add);
        this.start('Adding spreadsheet');
        const spreadsheet = await this.gsheet.addSpreadsheet(spreadsheetTitle);
        const { spreadsheetId, properties: { title = '' } = {}, spreadsheetUrl } = spreadsheet;
        this.stop();
        this.logRaw(`Spreadsheet "${title}" (${spreadsheetId}) successfully created > ${spreadsheetUrl}`, Object.assign({ operation: this.id }, spreadsheet));
    }
}
exports.default = Add;
Add.description = 'Add a worksheet with the specified title to the spreadsheet';
Add.examples = [
    `$ gsheet worksheet:add --spreadsheetTitle=<spreadsheetTitle>

Spreadsheet "<spreadsheetTitle>" (<id>) successfully created > https://docs.google.com/spreadsheets/d/<id>/edit
`,
];
Add.flags = Object.assign(Object.assign({}, base_class_1.default.flags), { spreadsheetTitle: command_1.flags.string({
        description: 'Title of the spreadsheet',
        required: true,
    }) });
